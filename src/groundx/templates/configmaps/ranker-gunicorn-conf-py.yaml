apiVersion: v1
kind: ConfigMap
metadata:
  name: ranker-gunicorn-conf-py-map
  namespace: {{ include "groundx.ns" . }}
  labels:
{{ include "groundx.renderDefaultLabels" (dict "name" "" "indent" 4 "root" $) }}
data:
  gunicorn_conf.py: |
    infolog = "-"
    accesslog = "-"
    errorlog = "-"

    loglevel = "{{ .Values.logLevel }}"
    workers = {{ .Values.ranker.api.workers }}
    threads = {{ .Values.ranker.api.threads }}
    timeout = {{ .Values.ranker.api.timeout }}
    timeout_keep_alive = 15

    worker_class = "uvicorn.workers.UvicornWorker"

    bind = "0.0.0.0:8080"

    wsgi_app = "ranker_server:app"
