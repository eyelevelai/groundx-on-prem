'aws: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 7ceb284dc3b869a93078dc13391866ce9c9dfbcef7aa4a5b0d8a7edf2626c888
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 7ceb284dc3b869a93078dc13391866ce9c9dfbcef7aa4a5b0d8a7edf2626c888
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 7ceb284dc3b869a93078dc13391866ce9c9dfbcef7aa4a5b0d8a7edf2626c888
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 7ceb284dc3b869a93078dc13391866ce9c9dfbcef7aa4a5b0d8a7edf2626c888
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 7ceb284dc3b869a93078dc13391866ce9c9dfbcef7aa4a5b0d8a7edf2626c888
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'cloud: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-agent
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-agent
      namespace: eyelevel
    spec:
      replicas: 4
      selector:
        matchLabels:
          app: extract-agent
      template:
        metadata:
          annotations:
            config-hash: bd15d242581d9d6046d16b51ec613036e3fa3bc57679db5525dcbea65af0c944
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-agent
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-agent
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-agent-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-download
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-download
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-download
      template:
        metadata:
          annotations:
            config-hash: bd15d242581d9d6046d16b51ec613036e3fa3bc57679db5525dcbea65af0c944
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-download
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-download
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-download-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-save
      template:
        metadata:
          annotations:
            config-hash: bd15d242581d9d6046d16b51ec613036e3fa3bc57679db5525dcbea65af0c944
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-save-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 2ee257a6597d2d64b9b3fb9f6d4e1e1490b4b0524207506f61ea45765d2eaa15
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 2ee257a6597d2d64b9b3fb9f6d4e1e1490b4b0524207506f61ea45765d2eaa15
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  6: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 2ee257a6597d2d64b9b3fb9f6d4e1e1490b4b0524207506f61ea45765d2eaa15
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  7: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 2ee257a6597d2d64b9b3fb9f6d4e1e1490b4b0524207506f61ea45765d2eaa15
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  8: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 2ee257a6597d2d64b9b3fb9f6d4e1e1490b4b0524207506f61ea45765d2eaa15
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'default: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'disabled: celery':
'empty: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 8f4fb323cb4661e9a26330a4768f0f27ec2064e6a2f0eb0dba447859f790202a
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'existing: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 0de2246e3c3210e37d477190276a11b8c8a79fb3824c4b5c09fd52600870687d
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.existing.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z file.existing.com 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 0de2246e3c3210e37d477190276a11b8c8a79fb3824c4b5c09fd52600870687d
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.existing.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z file.existing.com 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 0de2246e3c3210e37d477190276a11b8c8a79fb3824c4b5c09fd52600870687d
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.existing.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z file.existing.com 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 0de2246e3c3210e37d477190276a11b8c8a79fb3824c4b5c09fd52600870687d
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.existing.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z file.existing.com 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 0de2246e3c3210e37d477190276a11b8c8a79fb3824c4b5c09fd52600870687d
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.existing.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z file.existing.com 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'extract: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-agent
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-agent
      namespace: eyelevel
    spec:
      replicas: 4
      selector:
        matchLabels:
          app: extract-agent
      template:
        metadata:
          annotations:
            config-hash: d685fee8a09ac1bd6903eab2df3e4ed8d293969c9696377d63eae1e59b64841f
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-agent
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-save-secret
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-agent
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-agent-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-download
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-download
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-download
      template:
        metadata:
          annotations:
            config-hash: d685fee8a09ac1bd6903eab2df3e4ed8d293969c9696377d63eae1e59b64841f
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-download
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-save-secret
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-download
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-download-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-save
      template:
        metadata:
          annotations:
            config-hash: d685fee8a09ac1bd6903eab2df3e4ed8d293969c9696377d63eae1e59b64841f
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-save-secret
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 2Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-save-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  6: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  7: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  8: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'extract.ingest: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-agent
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-agent
      namespace: eyelevel
    spec:
      replicas: 4
      selector:
        matchLabels:
          app: extract-agent
      template:
        metadata:
          annotations:
            config-hash: e2e7af691f6acdf77c65cdc82fa582e870c8a57cff4693ad2bdb938d147cb35b
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-agent
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-agent
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-agent-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-download
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-download
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-download
      template:
        metadata:
          annotations:
            config-hash: e2e7af691f6acdf77c65cdc82fa582e870c8a57cff4693ad2bdb938d147cb35b
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-download
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-download
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-download-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-save
      template:
        metadata:
          annotations:
            config-hash: e2e7af691f6acdf77c65cdc82fa582e870c8a57cff4693ad2bdb938d147cb35b
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-save-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 312ea833a17a4544bad67918bc525c13e4f4d596f8964967521f84d7e154b769
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 312ea833a17a4544bad67918bc525c13e4f4d596f8964967521f84d7e154b769
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  6: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 312ea833a17a4544bad67918bc525c13e4f4d596f8964967521f84d7e154b769
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  7: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 312ea833a17a4544bad67918bc525c13e4f4d596f8964967521f84d7e154b769
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  8: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 312ea833a17a4544bad67918bc525c13e4f4d596f8964967521f84d7e154b769
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'extract.oai: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-agent
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-agent
      namespace: eyelevel
    spec:
      replicas: 4
      selector:
        matchLabels:
          app: extract-agent
      template:
        metadata:
          annotations:
            config-hash: 7e60feb21b49c572428e99f9de437db31486f20399cd1d9269349f91623768b3
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-agent
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-save-secret
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-agent
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-agent-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-download
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-download
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-download
      template:
        metadata:
          annotations:
            config-hash: 7e60feb21b49c572428e99f9de437db31486f20399cd1d9269349f91623768b3
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-download
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-save-secret
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-download
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-download-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-save
      template:
        metadata:
          annotations:
            config-hash: 7e60feb21b49c572428e99f9de437db31486f20399cd1d9269349f91623768b3
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-save-secret
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 2Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-save-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  6: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  7: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  8: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: ea7759490240984054d12c28e242701f81e9e7dbea0577888f969312d1b45e3b
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: eyelevel-secret-credentials
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z X.X.X.use2.cache.amazonaws.com 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-west-2.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: existing-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'metadata: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: myapp-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: myapp-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: myapp-correct
      template:
        metadata:
          annotations:
            config-hash: 7f0c7b0deae577ba6f01054925b21d4d8b357c3af3701b89dcbdd21de21f19d3
            supervisord-hash: b39bd7d75862c4a85780b4e3d76fe459b3beaa52f391376e7c95cb26ef6068ec
          labels:
            app: myapp-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: myapp-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z myapp.eyelevel.svc.cluster.local 6377; do echo waiting for cache; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: other-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: myapp-config-py-map
              name: config-volume
            - configMap:
                name: myapp-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: myapp-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: myapp-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: myapp-map
      template:
        metadata:
          annotations:
            config-hash: 7f0c7b0deae577ba6f01054925b21d4d8b357c3af3701b89dcbdd21de21f19d3
            prometheus.io/port: "8081"
            supervisord-hash: b39bd7d75862c4a85780b4e3d76fe459b3beaa52f391376e7c95cb26ef6068ec
          labels:
            app: myapp-map
            app.kubernetes.io/name: myapp
        spec:
          affinity:
            requiredDuringSchedulingIgnoredDuringExecution:
              - labelSelector:
                  matchExpressions:
                    - key: app
                      operator: In
                      values:
                        - myapp
                topologyKey: kubernetes.io/hostname
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: test.image:v1
              imagePullPolicy: Never
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: myapp-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                readOnlyRootFilesystem: true
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z myapp.eyelevel.svc.cluster.local 6377; do echo waiting for cache; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-file-storage
          securityContext:
            fsGroup: 2000
          serviceAccountName: other-service-account
          volumes:
            - configMap:
                name: myapp-config-py-map
              name: config-volume
            - configMap:
                name: myapp-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: myapp-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: myapp-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: myapp-ocr
      template:
        metadata:
          annotations:
            config-hash: 7f0c7b0deae577ba6f01054925b21d4d8b357c3af3701b89dcbdd21de21f19d3
            supervisord-hash: b39bd7d75862c4a85780b4e3d76fe459b3beaa52f391376e7c95cb26ef6068ec
          labels:
            app: myapp-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: myapp-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z myapp.eyelevel.svc.cluster.local 6377; do echo waiting for cache; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            disktype: ssd
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: other-service-account
          volumes:
            - configMap:
                name: myapp-config-py-map
              name: config-volume
            - configMap:
                name: myapp-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: myapp-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: myapp-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: myapp-process
      template:
        metadata:
          annotations:
            config-hash: 7f0c7b0deae577ba6f01054925b21d4d8b357c3af3701b89dcbdd21de21f19d3
            supervisord-hash: b39bd7d75862c4a85780b4e3d76fe459b3beaa52f391376e7c95cb26ef6068ec
          labels:
            app: myapp-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: myapp-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z myapp.eyelevel.svc.cluster.local 6377; do echo waiting for cache; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-file-storage
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: other-service-account
          tolerations:
            - effect: NoSchedule
              key: workload-type
              operator: Equal
              value: batch
          volumes:
            - configMap:
                name: myapp-config-py-map
              name: config-volume
            - configMap:
                name: myapp-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: myapp-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: myapp-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: myapp-save
      template:
        metadata:
          annotations:
            config-hash: 7f0c7b0deae577ba6f01054925b21d4d8b357c3af3701b89dcbdd21de21f19d3
            supervisord-hash: b39bd7d75862c4a85780b4e3d76fe459b3beaa52f391376e7c95cb26ef6068ec
          labels:
            app: myapp-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: myapp-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z myapp.eyelevel.svc.cluster.local 6377; do echo waiting for cache; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: test.image:v1
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: test-label-1
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: other-service-account
          tolerations:
            - effect: NoSchedule
              key: node
              value: test-label-1
          volumes:
            - configMap:
                name: myapp-config-py-map
              name: config-volume
            - configMap:
                name: myapp-save-supervisord-conf-map
              name: supervisord-volume
'minikube: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsGroup: 1001
                runAsNonRoot: true
                runAsUser: 1001
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            fsGroup: 1001
            fsGroupChangePolicy: OnRootMismatch
            runAsGroup: 1001
            runAsNonRoot: true
            runAsUser: 1001
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'openshift: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-only
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-only
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: ac70a23921bbd948745293be79d474cb3687af3882748951e056c20a584278a5
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: IfNotPresent
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: IfNotPresent
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu-memory
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu-memory
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
'phoenix: celery':
  1: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-agent
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-agent
      namespace: eyelevel
    spec:
      replicas: 4
      selector:
        matchLabels:
          app: extract-agent
      template:
        metadata:
          annotations:
            config-hash: cb0f64265ed3a9f525a7b32009e3e98504290a1870b11d14b0e0fadf7951f9c2
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-agent
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-agent
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 512Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-east-1.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-agent-supervisord-conf-map
              name: supervisord-volume
  2: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-download
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-download
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-download
      template:
        metadata:
          annotations:
            config-hash: cb0f64265ed3a9f525a7b32009e3e98504290a1870b11d14b0e0fadf7951f9c2
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-download
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-download
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-east-1.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-cpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-cpu
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-download-supervisord-conf-map
              name: supervisord-volume
  3: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: extract-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: extract-save
      namespace: eyelevel
    spec:
      replicas: 1
      selector:
        matchLabels:
          app: extract-save
      template:
        metadata:
          annotations:
            config-hash: cb0f64265ed3a9f525a7b32009e3e98504290a1870b11d14b0e0fadf7951f9c2
            supervisord-hash: 5b5e9887f0bdeba4bba8f32d5b8a61c0091a0282203b031ae21e1fd5f2025f3c
          labels:
            app: extract-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              envFrom:
                - secretRef:
                    name: extract-agent-secret
                - secretRef:
                    name: extract-save-secret
              image: public.ecr.aws/c9r4x6y5/eyelevel/extract:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: extract-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'celery_agents.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 2Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z X.s3.us-east-1.amazonaws.com 443; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-gpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-gpu
          volumes:
            - configMap:
                name: extract-config-py-map
              name: config-volume
            - configMap:
                name: extract-save-supervisord-conf-map
              name: supervisord-volume
  4: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-correct
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-correct
      namespace: eyelevel
    spec:
      replicas: 2
      selector:
        matchLabels:
          app: layout-correct
      template:
        metadata:
          annotations:
            config-hash: 24b00d4d44a91abda122ce7cb3e58cbcb6b223eb9adac608bc599337e1c01d10
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-correct
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-correct
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-gpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-gpu
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-correct-supervisord-conf-map
              name: supervisord-volume
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-map
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-map
      namespace: eyelevel
    spec:
      replicas: 2
      selector:
        matchLabels:
          app: layout-map
      template:
        metadata:
          annotations:
            config-hash: 24b00d4d44a91abda122ce7cb3e58cbcb6b223eb9adac608bc599337e1c01d10
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-map
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-map
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-gpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-gpu
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-map-supervisord-conf-map
              name: supervisord-volume
  6: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-ocr
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-ocr
      namespace: eyelevel
    spec:
      replicas: 2
      selector:
        matchLabels:
          app: layout-ocr
      template:
        metadata:
          annotations:
            config-hash: 24b00d4d44a91abda122ce7cb3e58cbcb6b223eb9adac608bc599337e1c01d10
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-ocr
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-ocr
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 1
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-gpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-gpu
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-ocr-supervisord-conf-map
              name: supervisord-volume
  7: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-process
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-process
      namespace: eyelevel
    spec:
      replicas: 2
      selector:
        matchLabels:
          app: layout-process
      template:
        metadata:
          annotations:
            config-hash: 24b00d4d44a91abda122ce7cb3e58cbcb6b223eb9adac608bc599337e1c01d10
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-process
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-process
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 100m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-gpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-gpu
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-process-supervisord-conf-map
              name: supervisord-volume
  8: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        app: layout-save
        appVersion: 0.1.0
        chart: groundx-0.1.0
        heritage: Helm
        version: 0.1.0
      name: layout-save
      namespace: eyelevel
    spec:
      replicas: 2
      selector:
        matchLabels:
          app: layout-save
      template:
        metadata:
          annotations:
            config-hash: 24b00d4d44a91abda122ce7cb3e58cbcb6b223eb9adac608bc599337e1c01d10
            supervisord-hash: 389d025411e33663295cbafcb9d7241d27e1d8736153cd1d14fa9c1b056107fe
          labels:
            app: layout-save
        spec:
          containers:
            - command:
                - /bin/sh
                - -c
                - |
                  export PYTHONPATH=/app && supervisord -c /app/supervisord.conf
              env:
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
              image: public.ecr.aws/c9r4x6y5/eyelevel/layout-process:0.1.0
              imagePullPolicy: Always
              livenessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 30
                periodSeconds: 30
              name: layout-save
              readinessProbe:
                exec:
                  command:
                    - /bin/sh
                    - -c
                    - ps aux | grep 'document.celery_process.app' | grep -v grep || exit 1
                initialDelaySeconds: 10
                periodSeconds: 30
              resources:
                requests:
                  cpu: 200m
                  memory: 1Gi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - ALL
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              volumeMounts:
                - mountPath: /app/config.py
                  name: config-volume
                  subPath: config.py
                - mountPath: /app/supervisord.conf
                  name: supervisord-volume
                  subPath: supervisord.conf
              workingDir: /app
          imagePullSecrets:
            - name: ecr-public-pull
          initContainers:
            - command:
                - sh
                - -c
                - until nc -z cache.eyelevel.svc.cluster.local 6379; do echo waiting for cache; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-cache
            - command:
                - sh
                - -c
                - until nc -z minio-tenant-hl.eyelevel.svc.cluster.local 9000; do echo waiting for file storage; sleep 2; done
              image: public.ecr.aws/c9r4x6y5/eyelevel/busybox:1.0.0
              imagePullPolicy: Always
              name: wait-for-file-storage
          nodeSelector:
            node: eyelevel-gpu
          securityContext:
            runAsNonRoot: true
            seccompProfile:
              type: RuntimeDefault
          tolerations:
            - effect: NoSchedule
              key: node
              value: eyelevel-gpu
          volumes:
            - configMap:
                name: layout-config-py-map
              name: config-volume
            - configMap:
                name: layout-save-supervisord-conf-map
              name: supervisord-volume
